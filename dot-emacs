;; -*- Emacs-Lisp -*-

(defvar dot-emacs-dir "~/.dot-emacs")

(if (fboundp 'normal-top-level-add-subdirs-to-load-path)
    (let* ((my-lisp-dir dot-emacs-dir)
           (default-directory my-lisp-dir))
      (add-to-list 'load-path my-lisp-dir)
      (normal-top-level-add-subdirs-to-load-path)))

;; Any customizations that are particular to the env
;; e.g. shared work configs


;; (if (file-exists-p "~/.local.el")
;;     (load "~/.local.el"))

(add-to-list 'exec-path "/usr/local/bin")
(add-to-list 'exec-path "~/.local/bin")

(require 'package)
(setq package-archives '(("elpa" . "http://tromey.com/elpa/")
                         ("melpa" . "http://melpa.milkbox.net/packages/")
                         ("elpy" . "http://jorgenschaefer.github.io/packages/")
                         ("gnu" . "http://elpa.gnu.org/packages/")
                         ("marmalade" . "http://marmalade-repo.org/packages/")))

(defvar package-list
  '(
    js2-mode
    ag  ; the silver searcher!
    anzu
    bbdb
    company
    color-identifiers-mode
    smex
    thrift
    diminish
    elpy
    crontab-mode
    gitconfig-mode
    gitignore-mode
    htmlize

    rtags
    helm-rtags
    company-rtags
    flycheck-rtags
    
    ;; ido
    ;; ido-ubiquitous
    ;; flx-ido
    ;; ido-vertical-mode

    auto-complete
    exec-path-from-shell

    flycheck
    
    go-mode
    go-eldoc
    go-autocomplete
    go-rename
    go-guru
    
    helm-c-yasnippet
    helm-commandlinefu
    helm-company
    helm-css-scss
    helm-descbinds
    helm-describe-modes
    helm-flx
    helm-flycheck
    helm-orgcard
    helm-projectile
    helm-pydoc
    helm-swoop
    helm-unicode

    markdown-mode

    js-comint
    js2-mode
    js2-refactor
    json-mode
    coffee-mode

    yaml-mode
    google-c-style
    multiple-cursors
    magit
    nose
    popwin
    projectile
    rainbow-mode
    rainbow-delimiters
    tangotango-theme
    web-mode

    wanderlust
    org-pomodoro
    ))

(package-initialize)

(or (file-exists-p package-user-dir)
    (package-refresh-contents))

;; install the missing packages
(dolist (package package-list)
  (unless (package-installed-p package)
    (package-install package)))

(require 'xhp-mode)
(setq auto-mode-alist (append '(("\\.phpt?$" . xhp-mode))
                              auto-mode-alist))

(require 'j-terminal-compat)
(require 'j-mc)
(require 'j-util)
(require 'j-globalkeys)
(require 'j-colors)
(require 'j-appearance)
(require 'j-behavior)
(require 'j-org)

(require 'j-go)
(require 'j-cpp)
(require 'j-php)
(require 'j-python)
(require 'j-js)
(require 'j-html)
(require 'j-css)
(require 'j-thrift)
(require 'j-yaml)
(require 'j-markdown)

(require 'j-helm)
(require 'j-completion)
(require 'j-web)

(require 'leg-mode)

(if (file-exists-p "~/.local-overrides.el")
    (load-file "~/.local-overrides.el"))

(with-eval-after-load 'flycheck
  (setq-default flycheck-disabled-checkers '(emacs-lisp-checkdoc)))

;; Sweet, sweet diffs
(add-hook 'ediff-load-hook
          (lambda ()
            (flycheck-mode nil)
            (setq ediff-highlight-all-diffs nil)
            (set-face-background
             ediff-current-diff-face-A "#1e2424")
            (set-face-background
             ediff-current-diff-face-B "#1e2424")
            (set-face-background
             ediff-current-diff-face-C "#1e2424")
            (make-face-italic
             ediff-current-diff-face-A)
            (make-face-italic
             ediff-current-diff-face-B)
            (make-face-italic
             ediff-current-diff-face-C)))
